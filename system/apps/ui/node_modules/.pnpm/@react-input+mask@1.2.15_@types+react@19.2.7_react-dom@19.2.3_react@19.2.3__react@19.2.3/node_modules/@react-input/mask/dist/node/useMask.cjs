"use strict";var e=require("./helpers-DM_v-mcG.cjs"),t=require("react"),r=require("@react-input/core");var a=function(e){return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return new e("".concat(r.join("\n\n"),"\n"))}};module.exports=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.mask,l=void 0===i?"":i,o=n.replacement,c=void 0===o?{}:o,p=n.showMask,s=void 0!==p&&p,u=n.separate,h=void 0!==u&&u,d=n.track,v=n.modify,m=n.onMask,f="string"==typeof c?e.formatToReplacementObject(c):c,k=t.useRef(null);return r.useInput({init:function(e){var t=e.controlled,r=e.initialValue;r=t||r?r:s?l:"","production"!==process.env.NODE_ENV&&function(e){var t=e.initialValue,r=e.mask,n=e.replacement;t.length>r.length&&console.error(a(Error)("The initialized value of the `value` or `defaultValue` property is longer than the value specified in the `mask` property. Check the correctness of the initialized value in the specified property.",'Invalid value: "'.concat(t,'".'),"To initialize an unmasked value, use the `format` utility. More details https://github.com/GoncharukOrg/react-input/tree/main/packages/mask#initializing-the-value."));var i=Object.keys(n).filter((function(e){return e.length>1}));i.length>0&&console.error(a(Error)("Object keys in the `replacement` property are longer than one character. Replacement keys must be one character long. Check the correctness of the value in the specified property.","Invalid keys: ".concat(i.join(", "),"."),"To initialize an unmasked value, use the `format` utility. More details https://github.com/GoncharukOrg/react-input/tree/main/packages/mask#initializing-the-value."));for(var l=r.slice(0,t.length),o=-1,c=0;c<l.length;c++){var p=Object.prototype.hasOwnProperty.call(n,l[c]);if(!(l[c]===t[c]||p&&n[l[c]].test(t[c]))){o=c;break}}-1!==o&&console.error(a(Error)("An invalid character was found in the initialized property value `value` or `defaultValue` (index: ".concat(o,"). Check the correctness of the initialized value in the specified property."),'Invalid value: "'.concat(t,'".'),"To initialize an unmasked value, use the `format` utility. More details https://github.com/GoncharukOrg/react-input/tree/main/packages/mask#initializing-the-value."))}({initialValue:r,mask:l,replacement:f});var n={mask:l,replacement:f,separate:h};return k.current={value:r,props:n,fallbackProps:n},{value:r}},tracking:function(t){var a,n=t.inputType,i=t.previousValue,o=t.addedValue,c=t.changeStart,p=t.changeEnd;if(null===k.current)throw new r.SyntheticChangeError("The state has not been initialized.");k.current.value!==i?k.current.props=k.current.fallbackProps:k.current.fallbackProps=k.current.props;var u=null==d?void 0:d(e._objectSpread2(e._objectSpread2({},"insert"===n?{inputType:n,data:o}:{inputType:n,data:null}),{},{value:i,selectionStart:c,selectionEnd:p}));if(!1===u)throw new r.SyntheticChangeError("Custom tracking stop.");null===u?o="":!0!==u&&void 0!==u&&(o=u);var m=e.unformat$1(i,e._objectSpread2({end:c},k.current.props)),g=e.unformat$1(i,e._objectSpread2({start:p},k.current.props)),y=RegExp("[^".concat(Object.keys(k.current.props.replacement).join(""),"]"),"g"),b=k.current.props.mask.replace(y,"");if(m&&(m=e.filter(m,{replacementChars:b,replacement:k.current.props.replacement,separate:k.current.props.separate}),b=b.slice(m.length)),o&&(o=e.filter(o,{replacementChars:b,replacement:k.current.props.replacement,separate:!1}),b=b.slice(o.length)),"insert"===n&&""===o)throw new r.SyntheticChangeError("The character does not match the key value of the `replacement` object.");if(k.current.props.separate){var w=k.current.props.mask.slice(c,p).replace(y,""),j=w.length-o.length;j<0?g=g.slice(-j):j>0&&(g=w.slice(-j)+g)}g&&(g=e.filter(g,{replacementChars:b,replacement:k.current.props.replacement,separate:k.current.props.separate}));var T=m+o+g,E=null!==(a=null==v?void 0:v(T))&&void 0!==a?a:{},O=E.mask,V=void 0===O?l:O,C=E.replacement,z=void 0===C?f:C,S=E.showMask,M=void 0===S?s:S,x=E.separate,P=void 0===x?h:x;"string"==typeof z&&(z=e.formatToReplacementObject(z));var _=function(t,r){var a=r.mask,n=r.replacement,i=r.separate,l=r.showMask,o=e.format$1(t,{mask:a,replacement:n,separate:i,showMask:l}),c=e.formatToParts$1(o,{mask:a,replacement:n}),p=e.generatePattern({mask:a,replacement:n}),s=e.generatePattern({mask:a,replacement:n},!0);return{value:o,input:t,parts:c,pattern:p,isValid:RegExp(s).test(o)}}(T,{mask:V,replacement:z,separate:P,showMask:M}),R=function(e){var t,r,a,n=e.inputType,i=e.value,l=e.addedValue,o=e.beforeChangeValue,c=e.parts,p=e.replacement,s=e.separate,u=c.filter((function(e){var t=e.type;return"input"===t||s&&"replacement"===t})),h=null===(t=u[o.length+l.length-1])||void 0===t?void 0:t.index,d=null===(r=u[o.length-1])||void 0===r?void 0:r.index,v=null===(a=u[o.length+l.length])||void 0===a?void 0:a.index;if("insert"===n){if(void 0!==h)return h+1;if(void 0!==v)return v;if(void 0!==d)return d+1}if("deleteForward"===n){if(void 0!==v)return v;if(void 0!==d)return d+1}if("deleteBackward"===n){if(void 0!==d)return d+1;if(void 0!==v)return v}var m=i.split("").findIndex((function(e){return Object.prototype.hasOwnProperty.call(p,e)}));return-1!==m?m:i.length}({inputType:n,value:_.value,addedValue:o,beforeChangeValue:m,parts:_.parts,replacement:z,separate:P});return k.current.value=_.value,k.current.props={mask:V,replacement:z,separate:P},{value:_.value,selectionStart:R,selectionEnd:R,__detail:_}},eventType:"input-mask",eventHandler:m})};
