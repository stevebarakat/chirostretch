import{c as e,d as t,g as r,e as a,h as n,i,j as l}from"./helpers-DBKBsbar.js";import{useRef as o}from"react";import{useInput as p,SyntheticChangeError as s}from"@react-input/core";var c=function(e){return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return new e("".concat(r.join("\n\n"),"\n"))}};function u(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=u.mask,h=void 0===d?"":d,v=u.replacement,m=void 0===v?{}:v,f=u.showMask,k=void 0!==f&&f,g=u.separate,y=void 0!==g&&g,w=u.track,b=u.modify,V=u.onMask,T="string"==typeof m?a(m):m,j=o(null);return p({init:function(e){var t=e.controlled,r=e.initialValue;r=t||r?r:k?h:"","production"!==process.env.NODE_ENV&&function(e){var t=e.initialValue,r=e.mask,a=e.replacement;t.length>r.length&&console.error(c(Error)("The initialized value of the `value` or `defaultValue` property is longer than the value specified in the `mask` property. Check the correctness of the initialized value in the specified property.",'Invalid value: "'.concat(t,'".'),"To initialize an unmasked value, use the `format` utility. More details https://github.com/GoncharukOrg/react-input/tree/main/packages/mask#initializing-the-value."));var n=Object.keys(a).filter((function(e){return e.length>1}));n.length>0&&console.error(c(Error)("Object keys in the `replacement` property are longer than one character. Replacement keys must be one character long. Check the correctness of the value in the specified property.","Invalid keys: ".concat(n.join(", "),"."),"To initialize an unmasked value, use the `format` utility. More details https://github.com/GoncharukOrg/react-input/tree/main/packages/mask#initializing-the-value."));for(var i=r.slice(0,t.length),l=-1,o=0;o<i.length;o++){var p=Object.prototype.hasOwnProperty.call(a,i[o]);if(!(i[o]===t[o]||p&&a[i[o]].test(t[o]))){l=o;break}}-1!==l&&console.error(c(Error)("An invalid character was found in the initialized property value `value` or `defaultValue` (index: ".concat(l,"). Check the correctness of the initialized value in the specified property."),'Invalid value: "'.concat(t,'".'),"To initialize an unmasked value, use the `format` utility. More details https://github.com/GoncharukOrg/react-input/tree/main/packages/mask#initializing-the-value."))}({initialValue:r,mask:h,replacement:T});var a={mask:h,replacement:T,separate:y};return j.current={value:r,props:a,fallbackProps:a},{value:r}},tracking:function(o){var p,c=o.inputType,u=o.previousValue,d=o.addedValue,v=o.changeStart,m=o.changeEnd;if(null===j.current)throw new s("The state has not been initialized.");j.current.value!==u?j.current.props=j.current.fallbackProps:j.current.fallbackProps=j.current.props;var f=null==w?void 0:w(n(n({},"insert"===c?{inputType:c,data:d}:{inputType:c,data:null}),{},{value:u,selectionStart:v,selectionEnd:m}));if(!1===f)throw new s("Custom tracking stop.");null===f?d="":!0!==f&&void 0!==f&&(d=f);var g=i(u,n({end:v},j.current.props)),V=i(u,n({start:m},j.current.props)),z=RegExp("[^".concat(Object.keys(j.current.props.replacement).join(""),"]"),"g"),O=j.current.props.mask.replace(z,"");if(g&&(g=l(g,{replacementChars:O,replacement:j.current.props.replacement,separate:j.current.props.separate}),O=O.slice(g.length)),d&&(d=l(d,{replacementChars:O,replacement:j.current.props.replacement,separate:!1}),O=O.slice(d.length)),"insert"===c&&""===d)throw new s("The character does not match the key value of the `replacement` object.");if(j.current.props.separate){var E=j.current.props.mask.slice(v,m).replace(z,""),C=E.length-d.length;C<0?V=V.slice(-C):C>0&&(V=E.slice(-C)+V)}V&&(V=l(V,{replacementChars:O,replacement:j.current.props.replacement,separate:j.current.props.separate}));var M=g+d+V,x=null!==(p=null==b?void 0:b(M))&&void 0!==p?p:{},P=x.mask,I=void 0===P?h:P,G=x.replacement,R=void 0===G?T:G,S=x.showMask,_=void 0===S?k:S,A=x.separate,N=void 0===A?y:A;"string"==typeof R&&(R=a(R));var B=function(a,n){var i=n.mask,l=n.replacement,o=n.separate,p=n.showMask,s=e(a,{mask:i,replacement:l,separate:o,showMask:p}),c=t(s,{mask:i,replacement:l}),u=r({mask:i,replacement:l}),d=r({mask:i,replacement:l},!0);return{value:s,input:a,parts:c,pattern:u,isValid:RegExp(d).test(s)}}(M,{mask:I,replacement:R,separate:N,showMask:_}),D=function(e){var t,r,a,n=e.inputType,i=e.value,l=e.addedValue,o=e.beforeChangeValue,p=e.parts,s=e.replacement,c=e.separate,u=p.filter((function(e){var t=e.type;return"input"===t||c&&"replacement"===t})),d=null===(t=u[o.length+l.length-1])||void 0===t?void 0:t.index,h=null===(r=u[o.length-1])||void 0===r?void 0:r.index,v=null===(a=u[o.length+l.length])||void 0===a?void 0:a.index;if("insert"===n){if(void 0!==d)return d+1;if(void 0!==v)return v;if(void 0!==h)return h+1}if("deleteForward"===n){if(void 0!==v)return v;if(void 0!==h)return h+1}if("deleteBackward"===n){if(void 0!==h)return h+1;if(void 0!==v)return v}var m=i.split("").findIndex((function(e){return Object.prototype.hasOwnProperty.call(s,e)}));return-1!==m?m:i.length}({inputType:c,value:B.value,addedValue:d,beforeChangeValue:g,parts:B.parts,replacement:R,separate:N});return j.current.value=B.value,j.current.props={mask:I,replacement:R,separate:N},{value:B.value,selectionStart:D,selectionEnd:D,__detail:B}},eventType:"input-mask",eventHandler:V})}export{u as default};
