module.exports=[57446,e=>{"use strict";e.i(2157),e.i(50227);var t=e.i(86290);e.i(47299),e.i(43698),e.i(27028),e.i(81111),e.i(51615),e.i(12057),e.i(57764),e.i(61095),e.i(9730);let a=0,n={START_BOUNDARY:a++,HEADER_FIELD_START:a++,HEADER_FIELD:a++,HEADER_VALUE_START:a++,HEADER_VALUE:a++,HEADER_VALUE_ALMOST_DONE:a++,HEADERS_ALMOST_DONE:a++,PART_DATA_START:a++,PART_DATA:a++,END:a++},r=e=>32|e,i=()=>{};class o{constructor(e){this.index=0,this.flags=0,this.onHeaderEnd=i,this.onHeaderField=i,this.onHeadersEnd=i,this.onHeaderValue=i,this.onPartBegin=i,this.onPartData=i,this.onPartEnd=i,this.boundaryChars={};const t=new Uint8Array((e="\r\n--"+e).length);for(let a=0;a<e.length;a++)t[a]=e.charCodeAt(a),this.boundaryChars[t[a]]=!0;this.boundary=t,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=n.START_BOUNDARY}write(e){let t,a,i=0,o=e.length,s=this.index,{lookbehind:E,boundary:d,boundaryChars:A,index:h,state:l,flags:D}=this,T=this.boundary.length,_=T-1,f=e.length,R=e=>{this[e+"Mark"]=i},u=e=>{delete this[e+"Mark"]},c=(e,t,a,n)=>{void 0!==t&&t===a||this[e](n&&n.subarray(t,a))},H=(t,a)=>{let n=t+"Mark";n in this&&(a?(c(t,this[n],i,e),delete this[n]):(c(t,this[n],e.length,e),this[n]=0))};for(i=0;i<o;i++)switch(t=e[i],l){case n.START_BOUNDARY:if(h===d.length-2){if(45===t)D|=2;else if(13!==t)return;h++;break}if(h-1==d.length-2){if(2&D&&45===t)l=n.END,D=0;else{if(2&D||10!==t)return;h=0,c("onPartBegin"),l=n.HEADER_FIELD_START}break}t!==d[h+2]&&(h=-2),t===d[h+2]&&h++;break;case n.HEADER_FIELD_START:l=n.HEADER_FIELD,R("onHeaderField"),h=0;case n.HEADER_FIELD:if(13===t){u("onHeaderField"),l=n.HEADERS_ALMOST_DONE;break}if(h++,45===t)break;if(58===t){if(1===h)return;H("onHeaderField",!0),l=n.HEADER_VALUE_START;break}if((a=r(t))<97||a>122)return;break;case n.HEADER_VALUE_START:if(32===t)break;R("onHeaderValue"),l=n.HEADER_VALUE;case n.HEADER_VALUE:13===t&&(H("onHeaderValue",!0),c("onHeaderEnd"),l=n.HEADER_VALUE_ALMOST_DONE);break;case n.HEADER_VALUE_ALMOST_DONE:if(10!==t)return;l=n.HEADER_FIELD_START;break;case n.HEADERS_ALMOST_DONE:if(10!==t)return;c("onHeadersEnd"),l=n.PART_DATA_START;break;case n.PART_DATA_START:l=n.PART_DATA,R("onPartData");case n.PART_DATA:if(s=h,0===h){for(i+=_;i<f&&!(e[i]in A);)i+=T;i-=_,t=e[i]}if(h<d.length)d[h]===t?(0===h&&H("onPartData",!0),h++):h=0;else if(h===d.length)h++,13===t?D|=1:45===t?D|=2:h=0;else if(h-1===d.length)if(1&D){if(h=0,10===t){D&=-2,c("onPartEnd"),c("onPartBegin"),l=n.HEADER_FIELD_START;break}}else 2&D&&45===t?(c("onPartEnd"),l=n.END,D=0):h=0;h>0?E[h-1]=t:s>0&&(c("onPartData",0,s,new Uint8Array(E.buffer,E.byteOffset,E.byteLength)),s=0,R("onPartData"),i--);break;case n.END:break;default:throw Error(`Unexpected state entered: ${l}`)}H("onHeaderField"),H("onHeaderValue"),H("onPartData"),this.index=h,this.state=l,this.flags=D}end(){if(this.state===n.HEADER_FIELD_START&&0===this.index||this.state===n.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==n.END)throw Error("MultipartParser.end(): stream ended unexpectedly")}}async function s(e,a){let n,r,i,s,E,d;if(!/multipart/i.test(a))throw TypeError("Failed to fetch");let A=a.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!A)throw TypeError("no or bad content-type header, no multipart boundary");let h=new o(A[1]||A[2]),l=[],D=new t.F,T=e=>{i+=u.decode(e,{stream:!0})},_=e=>{l.push(e)},f=()=>{let e=new t.a(l,d,{type:E});D.append(s,e)},R=()=>{D.append(s,i)},u=new TextDecoder("utf-8");for await(let t of(u.decode(),h.onPartBegin=function(){h.onPartData=T,h.onPartEnd=R,n="",r="",i="",s="",E="",d=null,l.length=0},h.onHeaderField=function(e){n+=u.decode(e,{stream:!0})},h.onHeaderValue=function(e){r+=u.decode(e,{stream:!0})},h.onHeaderEnd=function(){if(r+=u.decode(),"content-disposition"===(n=n.toLowerCase())){let e=r.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);e&&(s=e[2]||e[3]||""),(d=function(e){let t=e.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let a=t[2]||t[3]||"",n=a.slice(a.lastIndexOf("\\")+1);return(n=n.replace(/%22/g,'"')).replace(/&#(\d{4});/g,(e,t)=>String.fromCharCode(t))}(r))&&(h.onPartData=_,h.onPartEnd=f)}else"content-type"===n&&(E=r);r="",n=""},e))h.write(t);return h.end(),D}e.s(["toFormData",()=>s])}];

//# sourceMappingURL=b84a3_next-gravity-forms_server_index_esm_js_multipart-parser-BSDixSoX_3ac4f43a.js.map